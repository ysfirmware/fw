   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 18, 4
  12              		.thumb
  13              		.file	"Eval50xx-SysTick.c"
  21              	.Ltext0:
  22              		.align	2
  23              		.global	SysTickHandler
  24              		.thumb
  25              		.thumb_func
  27              	SysTickHandler:
  28              	.LFB0:
  29              		.file 1 "Eval50xx-SysTick.c"
   1:Eval50xx-SysTick.c **** /****************************************************
   2:Eval50xx-SysTick.c ****   Projekt: TMC562-EVAL
   3:Eval50xx-SysTick.c **** 
   4:Eval50xx-SysTick.c ****   Modul:   Eval562-SysTick.c
   5:Eval50xx-SysTick.c ****            Systick-Timer für 1ms-Takt
   6:Eval50xx-SysTick.c **** 
   7:Eval50xx-SysTick.c ****   Datum:   17.8.2009 OK
   8:Eval50xx-SysTick.c **** *****************************************************/
   9:Eval50xx-SysTick.c **** 
  10:Eval50xx-SysTick.c **** #include "stm32f10x_lib.h"
  11:Eval50xx-SysTick.c **** #include "bits.h"
  12:Eval50xx-SysTick.c **** 
  13:Eval50xx-SysTick.c **** #include "Eval50xx.h"
  14:Eval50xx-SysTick.c **** 
  15:Eval50xx-SysTick.c **** #define SYSTICK_PRE_EMPTION_PRIORITY 3
  16:Eval50xx-SysTick.c **** #define SYSTICK_SUB_PRIORITY 0
  17:Eval50xx-SysTick.c **** 
  18:Eval50xx-SysTick.c **** static volatile UINT SysTickTimer;
  19:Eval50xx-SysTick.c **** static volatile UCHAR SysTickDivFlag;
  20:Eval50xx-SysTick.c **** extern volatile UCHAR UART1TimeoutFlag;
  21:Eval50xx-SysTick.c **** extern volatile UINT UART1TimeoutTimer;
  22:Eval50xx-SysTick.c **** extern volatile UINT UART1TransmitDelayTimer;
  23:Eval50xx-SysTick.c **** extern volatile UCHAR UART2TimeoutFlag;
  24:Eval50xx-SysTick.c **** extern volatile UINT UART2TimeoutTimer;
  25:Eval50xx-SysTick.c **** extern volatile UINT UART2TransmitDelayTimer;
  26:Eval50xx-SysTick.c **** 
  27:Eval50xx-SysTick.c **** 
  28:Eval50xx-SysTick.c **** 
  29:Eval50xx-SysTick.c **** /*******************************************************************
  30:Eval50xx-SysTick.c ****    Funktion: SysTickHandler()
  31:Eval50xx-SysTick.c ****    Parameter: ---
  32:Eval50xx-SysTick.c **** 
  33:Eval50xx-SysTick.c ****    Rückgabewert: ---
  34:Eval50xx-SysTick.c **** 
  35:Eval50xx-SysTick.c ****    Zweck: Handler für den SysTick-Interrupt.
  36:Eval50xx-SysTick.c **** ********************************************************************/
  37:Eval50xx-SysTick.c **** void SysTickHandler(void)
  38:Eval50xx-SysTick.c **** {
  30              		.loc 1 38 0
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  39:Eval50xx-SysTick.c ****   if(SysTickDivFlag)
  34              		.loc 1 39 0
  35 0000 0F4B     		ldr	r3, .L9
  36 0002 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
  37 0004 5AB1     		cbz	r2, .L2
  40:Eval50xx-SysTick.c ****   {
  41:Eval50xx-SysTick.c ****     //1ms-Timer hochzählen (für GetSysTimer())
  42:Eval50xx-SysTick.c ****     SysTickTimer++;
  38              		.loc 1 42 0
  39 0006 5968     		ldr	r1, [r3, #4]
  43:Eval50xx-SysTick.c **** 
  44:Eval50xx-SysTick.c ****     //Timer für RS485-Sendeverzögerung herunterzählen
  45:Eval50xx-SysTick.c ****     #if defined(UART_INTERFACE_1)
  46:Eval50xx-SysTick.c ****     if(UART1TransmitDelayTimer>0) UART1TransmitDelayTimer--;
  40              		.loc 1 46 0
  41 0008 0E4A     		ldr	r2, .L9+4
  42              		.loc 1 42 0
  43 000a 0131     		adds	r1, r1, #1
  44 000c 5960     		str	r1, [r3, #4]
  45              		.loc 1 46 0
  46 000e 1368     		ldr	r3, [r2, #0]
  47 0010 13B1     		cbz	r3, .L3
  48 0012 1368     		ldr	r3, [r2, #0]
  49 0014 013B     		subs	r3, r3, #1
  50              	.LVL0:
  51 0016 1360     		str	r3, [r2, #0]
  52              	.L3:
  47:Eval50xx-SysTick.c ****     #endif
  48:Eval50xx-SysTick.c ****     #if defined(UART_INTERFACE_2)
  49:Eval50xx-SysTick.c ****     if(UART2TransmitDelayTimer>0) UART2TransmitDelayTimer--;
  50:Eval50xx-SysTick.c ****     #endif
  51:Eval50xx-SysTick.c **** 
  52:Eval50xx-SysTick.c ****     SysTickDivFlag=0;
  53              		.loc 1 52 0
  54 0018 0022     		movs	r2, #0
  55 001a 094B     		ldr	r3, .L9
  56              	.LVL1:
  57 001c 02E0     		b	.L7
  58              	.L2:
  53:Eval50xx-SysTick.c ****   }
  54:Eval50xx-SysTick.c ****   else SysTickDivFlag++;
  59              		.loc 1 54 0
  60 001e 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
  61 0020 0132     		adds	r2, r2, #1
  62 0022 D2B2     		uxtb	r2, r2
  63              	.L7:
  64 0024 1A70     		strb	r2, [r3, #0]
  55:Eval50xx-SysTick.c **** 
  56:Eval50xx-SysTick.c ****   //Timer für RS232/RS485-Timeout wird im 0,5ms-Takt heruntergezählt.
  57:Eval50xx-SysTick.c ****   #if defined(UART_INTERFACE_1)
  58:Eval50xx-SysTick.c ****   if(UART1TimeoutTimer>0)
  65              		.loc 1 58 0
  66 0026 084B     		ldr	r3, .L9+8
  67 0028 1A68     		ldr	r2, [r3, #0]
  68 002a 3AB1     		cbz	r2, .L6
  59:Eval50xx-SysTick.c ****   {
  60:Eval50xx-SysTick.c ****     UART1TimeoutTimer--;
  69              		.loc 1 60 0
  70 002c 1A68     		ldr	r2, [r3, #0]
  71 002e 013A     		subs	r2, r2, #1
  72              	.LVL2:
  73 0030 1A60     		str	r2, [r3, #0]
  61:Eval50xx-SysTick.c ****     if(UART1TimeoutTimer==0) UART1TimeoutFlag=TRUE;
  74              		.loc 1 61 0
  75 0032 1B68     		ldr	r3, [r3, #0]
  76 0034 13B9     		cbnz	r3, .L6
  77 0036 054B     		ldr	r3, .L9+12
  78 0038 0122     		movs	r2, #1
  79              	.LVL3:
  80 003a 1A70     		strb	r2, [r3, #0]
  81              	.LVL4:
  82              	.L6:
  62:Eval50xx-SysTick.c ****   }
  63:Eval50xx-SysTick.c ****   #endif
  64:Eval50xx-SysTick.c ****   #if defined(UART_INTERFACE_2)
  65:Eval50xx-SysTick.c ****   if(UART2TimeoutTimer>0)
  66:Eval50xx-SysTick.c ****   {
  67:Eval50xx-SysTick.c ****     UART2TimeoutTimer--;
  68:Eval50xx-SysTick.c ****     if(UART2TimeoutTimer==0) UART2TimeoutFlag=TRUE;
  69:Eval50xx-SysTick.c ****   }
  70:Eval50xx-SysTick.c ****   #endif
  71:Eval50xx-SysTick.c **** }
  83              		.loc 1 71 0
  84 003c 7047     		bx	lr
  85              	.L10:
  86 003e 00BF     		.align	2
  87              	.L9:
  88 0040 00000000 		.word	.LANCHOR0
  89 0044 00000000 		.word	UART1TransmitDelayTimer
  90 0048 00000000 		.word	UART1TimeoutTimer
  91 004c 00000000 		.word	UART1TimeoutFlag
  92              	.LFE0:
  94              		.align	2
  95              		.global	GetSysTimer
  96              		.thumb
  97              		.thumb_func
  99              	GetSysTimer:
 100              	.LFB2:
  72:Eval50xx-SysTick.c **** 
  73:Eval50xx-SysTick.c **** 
  74:Eval50xx-SysTick.c **** /*******************************************************************
  75:Eval50xx-SysTick.c ****    Funktion: InitSysTick
  76:Eval50xx-SysTick.c ****    Parameter: ---
  77:Eval50xx-SysTick.c **** 
  78:Eval50xx-SysTick.c ****    Rückgabewert: ---
  79:Eval50xx-SysTick.c **** 
  80:Eval50xx-SysTick.c ****    Zweck: Initialisierung des Systen-Timers.
  81:Eval50xx-SysTick.c **** ********************************************************************/
  82:Eval50xx-SysTick.c **** void InitSysTick(void)
  83:Eval50xx-SysTick.c **** {
  84:Eval50xx-SysTick.c ****   /* Select AHB clock(HCLK) as SysTick clock source */
  85:Eval50xx-SysTick.c ****   SysTick_CLKSourceConfig(SysTick_CLKSource_HCLK);
  86:Eval50xx-SysTick.c **** 
  87:Eval50xx-SysTick.c ****   /* SysTick interrupt each 500usec with Core clock equal to 72MHz */
  88:Eval50xx-SysTick.c ****   SysTick_SetReload(36000);
  89:Eval50xx-SysTick.c **** 
  90:Eval50xx-SysTick.c ****   /* Enable SysTick Counter */
  91:Eval50xx-SysTick.c ****   SysTick_CounterCmd(SysTick_Counter_Enable);
  92:Eval50xx-SysTick.c **** 
  93:Eval50xx-SysTick.c ****   NVIC_SystemHandlerPriorityConfig(SystemHandler_SysTick,
  94:Eval50xx-SysTick.c ****                             SYSTICK_PRE_EMPTION_PRIORITY, SYSTICK_SUB_PRIORITY);
  95:Eval50xx-SysTick.c ****   /* Enable SysTick interrupt */
  96:Eval50xx-SysTick.c ****   SysTick_ITConfig(ENABLE);
  97:Eval50xx-SysTick.c **** }
  98:Eval50xx-SysTick.c **** 
  99:Eval50xx-SysTick.c **** 
 100:Eval50xx-SysTick.c **** /*******************************************************************
 101:Eval50xx-SysTick.c ****    Funktion: GetSysTimer()
 102:Eval50xx-SysTick.c ****    Parameter: ---
 103:Eval50xx-SysTick.c **** 
 104:Eval50xx-SysTick.c ****    Rückgabewert: Zeit in ms
 105:Eval50xx-SysTick.c **** 
 106:Eval50xx-SysTick.c ****    Zweck: Auslesen des Systemtimers.
 107:Eval50xx-SysTick.c **** ********************************************************************/
 108:Eval50xx-SysTick.c **** UINT GetSysTimer(void)
 109:Eval50xx-SysTick.c **** {
 101              		.loc 1 109 0
 102              		@ args = 0, pretend = 0, frame = 0
 103              		@ frame_needed = 0, uses_anonymous_args = 0
 104              		@ link register save eliminated.
 110:Eval50xx-SysTick.c ****   return SysTickTimer;
 105              		.loc 1 110 0
 106 0050 014B     		ldr	r3, .L13
 107 0052 5868     		ldr	r0, [r3, #4]
 111:Eval50xx-SysTick.c **** }
 108              		.loc 1 111 0
 109 0054 7047     		bx	lr
 110              	.L14:
 111 0056 00BF     		.align	2
 112              	.L13:
 113 0058 00000000 		.word	.LANCHOR0
 114              	.LFE2:
 116              		.align	2
 117              		.global	InitSysTick
 118              		.thumb
 119              		.thumb_func
 121              	InitSysTick:
 122              	.LFB1:
 123              		.loc 1 83 0
 124              		@ args = 0, pretend = 0, frame = 0
 125              		@ frame_needed = 0, uses_anonymous_args = 0
 126 005c 08B5     		push	{r3, lr}
 127              	.LCFI0:
 128              		.loc 1 85 0
 129 005e 0420     		movs	r0, #4
 130 0060 FFF7FEFF 		bl	SysTick_CLKSourceConfig
 131              		.loc 1 88 0
 132 0064 48F6A040 		movw	r0, #36000
 133 0068 FFF7FEFF 		bl	SysTick_SetReload
 134              		.loc 1 91 0
 135 006c 0120     		movs	r0, #1
 136 006e FFF7FEFF 		bl	SysTick_CounterCmd
 137              		.loc 1 93 0
 138 0072 0448     		ldr	r0, .L17
 139 0074 0321     		movs	r1, #3
 140 0076 0022     		movs	r2, #0
 141 0078 FFF7FEFF 		bl	NVIC_SystemHandlerPriorityConfig
 142              		.loc 1 96 0
 143 007c 0120     		movs	r0, #1
 144 007e FFF7FEFF 		bl	SysTick_ITConfig
 145              		.loc 1 97 0
 146 0082 08BD     		pop	{r3, pc}
 147              	.L18:
 148              		.align	2
 149              	.L17:
 150 0084 9AC30200 		.word	181146
 151              	.LFE1:
 153              		.bss
 154              		.align	2
 155              		.set	.LANCHOR0,. + 0
 158              	SysTickDivFlag:
 159 0000 00       		.space	1
 160 0001 000000   		.space	3
 163              	SysTickTimer:
 164 0004 00000000 		.space	4
 215              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 Eval50xx-SysTick.c
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:22     .text:00000000 $t
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:27     .text:00000000 SysTickHandler
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:88     .text:00000040 $d
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:94     .text:00000050 $t
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:99     .text:00000050 GetSysTimer
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:113    .text:00000058 $d
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:116    .text:0000005c $t
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:121    .text:0000005c InitSysTick
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:150    .text:00000084 $d
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:154    .bss:00000000 $d
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:158    .bss:00000000 SysTickDivFlag
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:163    .bss:00000004 SysTickTimer
C:\DOKUME~1\Kahlbaum\LOKALE~1\Temp\ccLvyc6L.s:178    .debug_frame:00000010 $d

UNDEFINED SYMBOLS
UART1TransmitDelayTimer
UART1TimeoutTimer
UART1TimeoutFlag
SysTick_CLKSourceConfig
SysTick_SetReload
SysTick_CounterCmd
NVIC_SystemHandlerPriorityConfig
SysTick_ITConfig
